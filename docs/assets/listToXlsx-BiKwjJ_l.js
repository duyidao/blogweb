import{_ as v}from"./index-B_IvHfLj.js";import{u as a,w as m}from"./xlsx-ChWuxSKv.js";import{_ as k,r as i,o as r,c,a as e,j as u,C as h,F as V,f as w,D as _,p as F,d as g}from"./index-Sw9qLz3T.js";const y={setup(){const n=i({}),l=i([]),p=()=>{Object.keys(n).length!==0&&(l.value.push({...n.value,id:Date.now()}),n.value={})},o=i(null);return{info:n,tableData:l,clickFn:p,exportFn:()=>{if(l.value.length===0)return;const f=a.json_to_sheet(l.value),s=a.book_new();a.book_append_sheet(s,f,"sheet1"),m(s,"test.xlsx");const t=a.table_to_sheet(o.value),b=a.book_new();a.book_append_sheet(b,t,"sheet1"),m(b,"tableTest.xlsx")},tableRef:o}}},d=n=>(F("data-v-f4f48c21"),n=n(),g(),n),D={class:"xlsx"},S={class:"input"},I={for:"name"},j=d(()=>e("span",null,"名称：",-1)),B={for:"age"},C=d(()=>e("span",null,"年龄：",-1)),U={for:"level"},N=d(()=>e("span",null,"等级：",-1)),R={class:"buttons"},T={ref:"tableRef",class:"table-list"},E=d(()=>e("thead",null,[e("tr",null,[e("th",null,"名称"),e("th",null,"年龄"),e("th",null,"等级")])],-1));function L(n,l,p,o,x,f){const s=v;return r(),c("div",D,[e("div",S,[e("label",I,[j,u(s,{modelValue:o.info.name,"onUpdate:modelValue":l[0]||(l[0]=t=>o.info.name=t),type:"text",placeholder:"请输入名称"},null,8,["modelValue"])]),e("label",B,[C,u(s,{modelValue:o.info.age,"onUpdate:modelValue":l[1]||(l[1]=t=>o.info.age=t),type:"text",placeholder:"请输入年龄"},null,8,["modelValue"])]),e("label",U,[N,u(s,{modelValue:o.info.level,"onUpdate:modelValue":l[2]||(l[2]=t=>o.info.level=t),type:"text",placeholder:"请输入等级"},null,8,["modelValue"])]),e("div",R,[e("button",{class:"",onClick:l[3]||(l[3]=h((...t)=>o.clickFn&&o.clickFn(...t),["stop"]))},"数据添加到表格"),e("button",{class:"",onClick:l[4]||(l[4]=h((...t)=>o.exportFn&&o.exportFn(...t),["stop"]))},"表格数据导出xlsx")])]),e("table",T,[E,e("tbody",null,[(r(!0),c(V,null,w(o.tableData,t=>(r(),c("tr",{key:t.id},[e("td",null,_(t.name),1),e("td",null,_(t.age),1),e("td",null,_(t.level),1)]))),128))])],512)])}const X=k(y,[["render",L],["__scopeId","data-v-f4f48c21"]]);export{X as default};
