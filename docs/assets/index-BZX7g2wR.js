import{_ as S}from"./index-CINZDNIn.js";import{c as $}from"./likeme-GGPWDbUT.js";import{c as H}from"./peter-mI1k7hEE.js";import{_ as U,a as V}from"./shi-Ch9cTEql.js";import{_ as G,r as N,o as A,c as T,j as R,w as W,a as j,n as X,u as J,F as K,f as O}from"./index-BI5XnKsv.js";var z=function(c,l){return c<l?-1:c>l?1:0},B=function(c){return c.reduce(function(l,f){return l+f},0)},Q=function(){function c(f){this.colors=f}var l=c.prototype;return l.palette=function(){return this.colors},l.map=function(f){return f},c}(),Y=function(){function c(o,t,r){return(o<<10)+(t<<5)+r}function l(o){var t=[],r=!1;function a(){t.sort(o),r=!0}return{push:function(n){t.push(n),r=!1},peek:function(n){return r||a(),n===void 0&&(n=t.length-1),t[n]},pop:function(){return r||a(),t.pop()},size:function(){return t.length},map:function(n){return t.map(n)},debug:function(){return r||a(),t}}}function f(o,t,r,a,n,e,s){var u=this;u.r1=o,u.r2=t,u.g1=r,u.g2=a,u.b1=n,u.b2=e,u.histo=s}function g(){this.vboxes=new l(function(o,t){return z(o.vbox.count()*o.vbox.volume(),t.vbox.count()*t.vbox.volume())})}function m(o,t){if(t.count()){var r=t.r2-t.r1+1,a=t.g2-t.g1+1,n=Math.max.apply(null,[r,a,t.b2-t.b1+1]);if(t.count()==1)return[t.copy()];var e,s,u,h,d=0,p=[],C=[];if(n==r)for(e=t.r1;e<=t.r2;e++){for(h=0,s=t.g1;s<=t.g2;s++)for(u=t.b1;u<=t.b2;u++)h+=o[c(e,s,u)]||0;p[e]=d+=h}else if(n==a)for(e=t.g1;e<=t.g2;e++){for(h=0,s=t.r1;s<=t.r2;s++)for(u=t.b1;u<=t.b2;u++)h+=o[c(s,e,u)]||0;p[e]=d+=h}else for(e=t.b1;e<=t.b2;e++){for(h=0,s=t.r1;s<=t.r2;s++)for(u=t.g1;u<=t.g2;u++)h+=o[c(s,u,e)]||0;p[e]=d+=h}return p.forEach(function(M,v){C[v]=d-M}),function(M){var v,w,b,x,_,I=M+"1",y=M+"2",E=0;for(e=t[I];e<=t[y];e++)if(p[e]>d/2){for(b=t.copy(),x=t.copy(),_=(v=e-t[I])<=(w=t[y]-e)?Math.min(t[y]-1,~~(e+w/2)):Math.max(t[I],~~(e-1-v/2));!p[_];)_++;for(E=C[_];!E&&p[_-1];)E=C[--_];return b[y]=_,x[I]=b[y]+1,[b,x]}}(n==r?"r":n==a?"g":"b")}}return f.prototype={volume:function(o){var t=this;return t._volume&&!o||(t._volume=(t.r2-t.r1+1)*(t.g2-t.g1+1)*(t.b2-t.b1+1)),t._volume},count:function(o){var t=this,r=t.histo;if(!t._count_set||o){var a,n,e,s=0;for(a=t.r1;a<=t.r2;a++)for(n=t.g1;n<=t.g2;n++)for(e=t.b1;e<=t.b2;e++)s+=r[c(a,n,e)]||0;t._count=s,t._count_set=!0}return t._count},copy:function(){var o=this;return new f(o.r1,o.r2,o.g1,o.g2,o.b1,o.b2,o.histo)},avg:function(o){var t=this,r=t.histo;if(!t._avg||o){var a,n,e,s,u=0,h=0,d=0,p=0;if(t.r1===t.r2&&t.g1===t.g2&&t.b1===t.b2)t._avg=[t.r1<<3,t.g1<<3,t.b1<<3];else{for(n=t.r1;n<=t.r2;n++)for(e=t.g1;e<=t.g2;e++)for(s=t.b1;s<=t.b2;s++)u+=a=r[c(n,e,s)]||0,h+=a*(n+.5)*8,d+=a*(e+.5)*8,p+=a*(s+.5)*8;t._avg=u?[~~(h/u),~~(d/u),~~(p/u)]:[~~(8*(t.r1+t.r2+1)/2),~~(8*(t.g1+t.g2+1)/2),~~(8*(t.b1+t.b2+1)/2)]}}return t._avg},contains:function(o){var t=this,r=o[0]>>3;return gval=o[1]>>3,bval=o[2]>>3,r>=t.r1&&r<=t.r2&&gval>=t.g1&&gval<=t.g2&&bval>=t.b1&&bval<=t.b2}},g.prototype={push:function(o){this.vboxes.push({vbox:o,color:o.avg()})},palette:function(){return this.vboxes.map(function(o){return o.color})},size:function(){return this.vboxes.size()},map:function(o){for(var t=this.vboxes,r=0;r<t.size();r++)if(t.peek(r).vbox.contains(o))return t.peek(r).color;return this.nearest(o)},nearest:function(o){for(var t,r,a,n=this.vboxes,e=0;e<n.size();e++)((r=Math.sqrt(Math.pow(o[0]-n.peek(e).color[0],2)+Math.pow(o[1]-n.peek(e).color[1],2)+Math.pow(o[2]-n.peek(e).color[2],2)))<t||t===void 0)&&(t=r,a=n.peek(e).color);return a},forcebw:function(){var o=this.vboxes;o.sort(function(n,e){return z(B(n.color),B(e.color))});var t=o[0].color;t[0]<5&&t[1]<5&&t[2]<5&&(o[0].color=[0,0,0]);var r=o.length-1,a=o[r].color;a[0]>251&&a[1]>251&&a[2]>251&&(o[r].color=[255,255,255])}},{quantize:function(o,t){if(!Number.isInteger(t)||t<1||t>256)throw new Error("Invalid maximum color count. It must be an integer between 1 and 256.");if(!o.length||t<2||t>256||!o.length||t<2||t>256)return!1;for(var r=[],a=new Set,n=0;n<o.length;n++){var e=o[n],s=e.join(",");a.has(s)||(a.add(s),r.push(e))}if(r.length<=t)return new Q(r);var u=function(v){var w,b=new Array(32768);return v.forEach(function(x){w=c(x[0]>>3,x[1]>>3,x[2]>>3),b[w]=(b[w]||0)+1}),b}(o);u.forEach(function(){});var h=function(v,w){var b,x,_,I=1e6,y=0,E=1e6,q=0,L=1e6,P=0;return v.forEach(function(D){(b=D[0]>>3)<I?I=b:b>y&&(y=b),(x=D[1]>>3)<E?E=x:x>q&&(q=x),(_=D[2]>>3)<L?L=_:_>P&&(P=_)}),new f(I,y,E,q,L,P,w)}(o,u),d=new l(function(v,w){return z(v.count(),w.count())});function p(v,w){for(var b,x=v.size(),_=0;_<1e3;){if(x>=w||_++>1e3)return;if((b=v.pop()).count()){var I=m(u,b),y=I[0],E=I[1];if(!y)return;v.push(y),E&&(v.push(E),x++)}else v.push(b),_++}}d.push(h),p(d,.75*t);for(var C=new l(function(v,w){return z(v.count()*v.volume(),w.count()*w.volume())});d.size();)C.push(d.pop());p(C,t);for(var M=new g;C.size();)M.push(C.pop());return M}}}().quantize,F=function(c){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.width=this.canvas.width=c.naturalWidth,this.height=this.canvas.height=c.naturalHeight,this.context.drawImage(c,0,0,this.width,this.height)};F.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)};var k=function(){};k.prototype.getColor=function(c,l){return l===void 0&&(l=10),this.getPalette(c,5,l)[0]},k.prototype.getPalette=function(c,l,f){var g=function(r){var a=r.colorCount,n=r.quality;if(a!==void 0&&Number.isInteger(a)){if(a===1)throw new Error("colorCount should be between 2 and 20. To get one color, call getColor() instead of getPalette()");a=Math.max(a,2),a=Math.min(a,20)}else a=10;return(n===void 0||!Number.isInteger(n)||n<1)&&(n=10),{colorCount:a,quality:n}}({colorCount:l,quality:f}),m=new F(c),o=function(r,a,n){for(var e,s,u,h,d,p=r,C=[],M=0;M<a;M+=n)s=p[0+(e=4*M)],u=p[e+1],h=p[e+2],((d=p[e+3])===void 0||d>=125)&&(s>250&&u>250&&h>250||C.push([s,u,h]));return C}(m.getImageData().data,m.width*m.height,g.quality),t=Y(o,g.colorCount);return t?t.palette():null},k.prototype.getColorFromUrl=function(c,l,f){var g=this,m=document.createElement("img");m.addEventListener("load",function(){var o=g.getPalette(m,5,f);l(o[0],c)}),m.src=c},k.prototype.getImageData=function(c,l){var f=new XMLHttpRequest;f.open("GET",c,!0),f.responseType="arraybuffer",f.onload=function(){if(this.status==200){var g=new Uint8Array(this.response);i=g.length;for(var m=new Array(i),o=0;o<g.length;o++)m[o]=String.fromCharCode(g[o]);var t=m.join(""),r=window.btoa(t);l("data:image/png;base64,"+r)}},f.send()},k.prototype.getColorAsync=function(c,l,f){var g=this;this.getImageData(c,function(m){var o=document.createElement("img");o.addEventListener("load",function(){var t=g.getPalette(o,5,f);l(t[0],this)}),o.src=m})};const Z={class:"iframe-box box"},tt=["src","onMouseenter"],ot={__name:"index",setup(c){const l=new k,f=[$,H,U,V],g=N("transparent"),m=N(-1),o=async(r,a)=>{m.value=a;let n=await l.getColor(r,5);console.log("colors",n),g.value=`rgb(${n[0]}, ${n[1]}, ${n[2]})`,console.log("bgColor.value",g.value)},t=()=>{m.value=-1,g.value="transparent"};return(r,a)=>{const n=S;return A(),T("div",Z,[R(n,null,{default:W(()=>[j("div",{class:"palette-imgs",style:X({"--bg":J(g)})},[(A(),T(K,null,O(f,(e,s)=>j("img",{key:e,src:e,onMouseenter:u=>o(u.target,s),onMouseleave:t},null,40,tt)),64))],4)]),_:1})])}}},ut=G(ot,[["__scopeId","data-v-d84445e6"]]);export{ut as default};
