import{u as s,w as x}from"./xlsx-ChWuxSKv.js";import{_ as k,r as a,o as i,c as d,a as e,G as r,C as c,O as u,D as v,F as w,f as g,E as f,p as F,d as y}from"./index-DBcL6Esc.js";const D={setup(){const n=a({}),l=a([]),p=()=>{Object.keys(n).length!==0&&(l.value.push({...n.value,id:Date.now()}),n.value={})},o=a(null);return{info:n,tableData:l,clickFn:p,exportFn:()=>{if(l.value.length===0)return;const _=s.json_to_sheet(l.value),t=s.book_new();s.book_append_sheet(t,_,"sheet1"),x(t,"test.xlsx");const m=s.table_to_sheet(o.value),b=s.book_new();s.book_append_sheet(b,m,"sheet1"),x(b,"tableTest.xlsx")},tableRef:o}}},S=n=>(F("data-v-3fcdc0fe"),n=n(),y(),n),V={class:"xlsx"},I={class:"input"},T={for:"name"},B={for:"age"},C={for:"level"},U={class:"buttons"},j={ref:"tableRef",class:"table-list"},E=S(()=>e("thead",null,[e("tr",null,[e("th",null,"名称"),e("th",null,"年龄"),e("th",null,"等级")])],-1));function M(n,l,p,o,h,_){return i(),d("div",V,[e("div",I,[e("label",T,[r(" 名称： "),c(e("input",{"onUpdate:modelValue":l[0]||(l[0]=t=>o.info.name=t),class:"",type:"text",name:"name",id:"name"},null,512),[[u,o.info.name]])]),e("label",B,[r(" 年龄： "),c(e("input",{"onUpdate:modelValue":l[1]||(l[1]=t=>o.info.age=t),class:"",type:"text",name:"age",id:"age"},null,512),[[u,o.info.age]])]),e("label",C,[r(" 等级： "),c(e("input",{"onUpdate:modelValue":l[2]||(l[2]=t=>o.info.level=t),class:"",type:"text",name:"level",id:"level"},null,512),[[u,o.info.level]])]),e("div",U,[e("button",{class:"",onClick:l[3]||(l[3]=v((...t)=>o.clickFn&&o.clickFn(...t),["stop"]))},"数据添加到表格"),e("button",{class:"",onClick:l[4]||(l[4]=v((...t)=>o.exportFn&&o.exportFn(...t),["stop"]))},"表格数据导出xlsx")])]),e("table",j,[E,e("tbody",null,[(i(!0),d(w,null,g(o.tableData,t=>(i(),d("tr",{key:t.id},[e("td",null,f(t.name),1),e("td",null,f(t.age),1),e("td",null,f(t.level),1)]))),128))])],512)])}const R=k(D,[["render",M],["__scopeId","data-v-3fcdc0fe"]]);export{R as default};
